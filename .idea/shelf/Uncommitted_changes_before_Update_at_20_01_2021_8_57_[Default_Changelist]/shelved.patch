Index: LARQA/background.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>//todo Выводить изменения в опциях и параметрах красиво\r\n//todo Допилить проверку параметров\r\n//todo Допилить статус, отображать одобрен\\нет, менять цвет в зависимости от этого, отражать allowed by PL\r\n\r\nclass Helper{\r\n\r\n\tconstructor(\r\n\t\tdebug_list,\r\n\t\tissues_list,\r\n\t\tchanged_options_list,\r\n\t) {\r\n\t\tthis.debug_list = debug_list;\r\n\t\tthis.issues_list = issues_list;\r\n\t\tthis.changed_options_list = changed_options_list;\r\n\t}\r\n\r\n\tinitHelperData(){\r\n\t\tthis.debug_list = '';\r\n\t\tthis.issues_list = new Map();\r\n\t\tthis.changed_options_list = '';\r\n\t}\r\n\r\n\tcallWindow() { //вызов окна запроса\r\n\r\n\t\twindow.layout_window = window.open( // собственно основное окно\r\n\t\t\t'prefilled.html',\r\n\t\t\t'_blank');\r\n\r\n\t\tlayout_window.onload = function () { // действия после загрузки окна\r\n\r\n\t\t\tct.analysis.initOptionsDefaults();\r\n\t\t\tct.initDetailsArray();\r\n\t\t\tct.initOptionsArray();\r\n\t\t\tct.id.initId();\r\n\t\t\tct.status.initStatus();\r\n\t\t\tct.analysis.initOptionsDefaults();\r\n\r\n\t\t\twindow.pub_strcnt = 0; //счётчик строк в таблице\r\n\r\n\t\t\tct.analysis.checkDetails();\r\n\r\n\t\t\tct.drawDetailsBlock();\r\n\t\t\tct.drawOptionsBlock();\r\n\t\t\tct.drawStatusBlock();\r\n\r\n\r\n\t\t\tct.analysis.checkOptions();\r\n\r\n\t\t\thelper.showIssuesList();\r\n\t\t\thelper.showDebugMsgList();\r\n\t\t\thelper.showChangedOptionsList();\r\n\r\n\r\n\t\t\tlayout_window.focus();\r\n\r\n\t\t}//вызов окна запроса\r\n\r\n\t} //вызов рабочего окна\r\n\r\n\tfindBetween(string, left, right){\r\n\t\tlet startfrom;\r\n\t\tlet endwith;\r\n\t\tfor (let i=0; i<string.length; i++){\r\n\t\t\tif (string.slice(i,i+left.length) === left) {\r\n\t\t\t\tstartfrom = i+left.length;\r\n\t\t\t}\r\n\t\t\tif (string.slice(i,i+right.length) === right) {\r\n\t\t\t\tendwith = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn (string.slice(startfrom,endwith))\r\n\t}\r\n\r\n\tgetHtmlSection(section_name) { //извлекает html секции по Details.section_id\r\n\r\n\t\tconst signature = `<div class=\"section_block\" data-section=\"` + section_name + `\">`; // подпись берём из параметра функции\r\n\t\tconst start_section_position = extracted_html.indexOf(signature);// начальная позиция определена\r\n\t\tlet end_section_position = null;\r\n\t\tfor (let i = start_section_position + 1; i <= extracted_html.length; i++) {\r\n\t\t\tif ((extracted_html.slice(i, i + 40)) === '<div class=\"section_block\" data-section=') {\r\n\t\t\t\tend_section_position = i; // конечная позиция определена\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn extracted_html.slice(start_section_position, end_section_position);\r\n\r\n\t}\r\n\r\n\tgetDetailSignatureForSection(section_id, signature) { //ищет Detail.value по Detail.signature внутри секции Details.section_id\r\n\r\n\t\tconst html_section = this.getHtmlSection(section_id); // секция определена\r\n\t\tlet start_value_position;\r\n\t\tlet end_value_position;\r\n\r\n\t\tif (html_section.includes(signature)) { // 11- это символы <td>:&nbsp;\r\n\t\t\tstart_value_position = (html_section.indexOf(signature) + signature.length + 11); //стартовая позиция для искомого значения\r\n\t\t} else {\r\n\t\t\t//helper.debugMessage('Signature not found :<a href=\"'+ signature +'\">SIGNATURE</a>');\r\n\t\t\treturn 'INVISIBLE';\r\n\t\t}\r\n\r\n\t\tfor (let i = start_value_position; i <= html_section.length; i++) {\r\n\t\t\tif ((html_section.slice(i, i + 5)) === '</td>') {\r\n\t\t\t\tend_value_position = i; //конечная позиция определена\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn html_section.slice(start_value_position, end_value_position);\r\n\r\n\t}\r\n\r\n\taddTag(position_tag_id, align, html) { // добавляет тег на страницу\r\n\r\n\t\tlayout_window.document.getElementById(position_tag_id).insertAdjacentHTML(align, html);\r\n\r\n\t}\r\n\r\n\tgetOptionsFromJSON(json) { //возвращает массив объектов OPTION из JSON настроек\r\n\r\n\t\tconst jsonobj = JSON.parse(json);\r\n\t\tlet temp = [];\r\n\t\t$.each(jsonobj, function (name, value) {\r\n\t\t\ttemp.push(new Option(name, value, 0))\r\n\t\t})\r\n\t\treturn temp;\r\n\t}\r\n\r\n\ttrimAndLow (option_value) {\r\n\r\n\t\tlet resstring = option_value;\r\n\t\tresstring = resstring.toString().trim();\r\n\t\tresstring = resstring.toLowerCase();\r\n\t\treturn (resstring);\r\n\r\n\t}\r\n\r\n\taddToIssuesList(issue,weight){\r\n\t\tthis.issues_list.set(issue,weight);\r\n\t}\r\n\r\n\tshowIssuesList(){\r\n\r\n\t\tlet list_of_issues ='';\r\n\t\tlet amount_of_issues = 0;\r\n\t\tlet issues_number = 0;\r\n\t\tfor (let entry of this.issues_list.keys()) {\r\n\t\t\tlist_of_issues += ' - '+entry +'<br>';\r\n\t\t}\r\n\t\tfor (let entry of this.issues_list.values()) {\r\n\t\t\tamount_of_issues += Number(entry);\r\n\t\t\tissues_number++;\r\n\t\t}\r\n\r\n\t\tif (list_of_issues !==''){\r\n\t\t\thelper.addTag('details_table-tbody', 'afterbegin', (\r\n\t\t\t\t' <tr class=\"status_table_inner\">Обратить внимание!('+issues_number+'): <br><b>' + list_of_issues +\r\n\t\t\t\t' </b></tr>' +\r\n\t\t\t\t' <tr class=\"status_table_inner\">Итоговый вес: <b>' + amount_of_issues + '</b></tr>'\r\n\t\t\t));\r\n\t\t\tlist_of_issues = '';\r\n\t\t}\r\n\t}\r\n\r\n\tdebugMessage(msg){\r\n\t\tthis.debug_list += ('<p id=\"debug\">Debug message: ' + msg + '</p>');\r\n\t}\r\n\r\n\tshowDebugMsgList(){\r\n\t\tif (this.debug_list !==''){\r\n\t\t\thelper.addTag('status_table-tbody', 'beforeend', ('<tr id=\"debug\"><td>'+this.debug_list+'</td></tr>'));\r\n\t\t\tthis.debug_list = '';\r\n\t\t}\r\n\t}\r\n\r\n\taddToChangedOptionsList(msg){\r\n\t\tthis.changed_options_list += ('<p id=\"debug\">' + msg + '</p>');\r\n\t}\r\n\r\n\tshowChangedOptionsList(){\r\n\t\tif (this.changed_options_list !==''){\r\n\t\t\thelper.addTag('options_table-tbody', 'afterbegin', ('<div>Изменены опции:'+this.changed_options_list+'</div>'));\r\n\t\t\tthis.changed_options_list = '';\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Id {\r\n\r\n\tconstructor(\r\n\t\tvalue,\r\n\t\tlink_noc,\r\n\t\tlink_user\r\n\t) {\r\n\t\tthis.value = value;\r\n\t\tthis.link_noc = link_noc;\r\n\t\tthis.link_user = link_user;\r\n\t}\r\n\r\n\tinitId() { // берёт request ID из массива HTML и делает ссылки на него\r\n\r\n\t\tconst signature = `<div class=\"panel-heading\">Запрос `;\r\n\r\n\t\tif (extracted_html.includes(signature)) {\r\n\t\t\tlet start_position = ( (extracted_html.indexOf(signature) + (signature.length) ) )\r\n\t\t\tthis.value = (extracted_html.slice (start_position, (parseInt(start_position) + 32) ) );\r\n\t\t} else\r\n\r\n\t\tif (this.value) { //формирует ссылки на ПУ и на НОК\r\n\t\t\tthis.link_noc = 'https://cleantalk.org/noc/requests?request_id=' + this.value;\r\n\t\t\tthis.link_user = 'https://cleantalk.org/my/show_requests?request_id=' + this.value;\r\n\t\t}\r\n\t} // берёт request ID из массива HTML и делает ссылки на него\r\n}\r\n\r\nclass Status {\r\n\r\n\tconstructor(\r\n\t\tagent,\r\n\t\tisAllowed,\r\n\t\tfilters,\r\n\t\ttype\r\n\t) {\r\n\t\tthis.agent = agent;\r\n\t\tthis.isAllowed = isAllowed;\r\n\t\tthis.filters = filters;\r\n\t\tthis.type = type; //todo допилить status.type\r\n\t}\r\n\r\n\tinitStatus() {\r\n\r\n\t\tif (ct.details) {\r\n\r\n\t\t\t//поиск агента\r\n\t\t\tthis.agent = ct.getDetailValueByName('ct_agent');\r\n\r\n\t\t\tif (this.agent !== CURRENT_VERSIONS.get('wordpress'))  {\r\n\t\t\t\tthis.agent = '<a title=\"Плагин устарел\" style  = \"color: red\">'+this.agent+'</a>';\r\n\t\t\t\thelper.addToIssuesList('Версия плагина устарела','3');\r\n\t\t\t\tct.setDetailPropertyByName('ct_agent','css_id','BAD');\r\n\r\n\t\t\t} else {\r\n\t\t\t\tthis.agent = '<a title=\"Версия в порядке\" style = \"color: green\">'+this.agent+'</a>';\r\n\t\t\t}\r\n\r\n\t\t\t//поиск одобрен/нет\r\n\t\t\tthis.isAllowed = ct.getDetailValueByName('is_allowed');\r\n\r\n\t\t\t//поиск типа запроса\r\n\t\t\tswitch (ct.getDetailValueByName('method_name')) {\r\n\t\t\t\tcase 'check_newuser':\r\n\t\t\t\t\tthis.type = \"registration\";\r\n\t\t\t\t\t//TODO вот тут можно допилить условия для поиска комментария по comment_type\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'check_message':\r\n\t\t\t\t\tthis.type = \"comment or contact form\";\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t}\r\n\r\n\t\t} else alert('ct.details - details block not found');\r\n\r\n\t\tif (this.isAllowed) {this.isAllowed = 'ALLOWED'} else this.isAllowed = 'DENIED';\r\n\r\n\t\t// поиск значения фильтров - тот ещё геморрой\r\n\r\n\t\tconst signature = `\"Добавить в произвольный блок\"></span>&nbsp;</td>`;\r\n\t\tconst filters_section = helper.getHtmlSection('filters');\r\n\t\tconst start_fs = filters_section.indexOf(signature) + 49;\r\n\r\n\t\tlet end_fs = null;\r\n\r\n\t\tfor (let i = start_fs + 1; i <= filters_section.length; i++) {\r\n\r\n\t\t\tif ((filters_section.slice(i, i + 2)) === 'R:') {\r\n\t\t\t\tend_fs = i;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\t// отрезает строку филтьтров, удаляет форматирование, оставляет только ффильтр и значение\r\n\t\tthis.filters = (filters_section.slice(start_fs, end_fs));\r\n\r\n\t\tfor (let i = 0; i <= this.filters.length; i++) { //удаляет форматирование, оставляет только ффильтр и значение\r\n\r\n\t\t\tif (this.filters.slice(i, i + 4) === '<td>') {\r\n\t\t\t\tthis.filters = this.filters.slice(0, i) + this.filters.slice(i + 4, this.filters.length)\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.filters.slice(i, i + 6) === '&nbsp;') {\r\n\t\t\t\tthis.filters = this.filters.slice(0, i) + this.filters.slice(i + 6, this.filters.length)\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.filters.slice(i, i + 5) === '</td>') {\r\n\t\t\t\tthis.filters = this.filters.slice(0, i) + this.filters.slice(i + 5, this.filters.length)\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.filters.slice(i, i + 32) === '<a href=\"#\" class=\"edit_filter\">') {\r\n\t\t\t\tthis.filters = this.filters.slice(0, i) + this.filters.slice(i + 32, this.filters.length);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.filters.slice(i, i + 4) === '</a>') {\r\n\t\t\t\tthis.filters = this.filters.slice(0, i) + this.filters.slice(i + 4, this.filters.length);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//экстракция IP адреса по регулярке\r\n\t\tif (ct.getDetailValueByName('sender_ip',) !== '') {\r\n\t\t\tpub_ip_trimmed = ct.getDetailValueByName('sender_ip',);\r\n\t\t\tpub_ip_trimmed = pub_ip_trimmed.match(/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)/);\r\n\t\t\tpub_ip_trimmed = pub_ip_trimmed[0];\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass Detail {\r\n\r\n\tconstructor(\r\n\r\n\t\tname,\r\n\t\tblock_id,\r\n\t\tsignature,\r\n\t\tvalue,\r\n\t\tcss_id,\r\n\t\tsection_id\r\n\r\n\t) {\r\n\r\n\t\t//Init class\r\n\t\tthis.name = name;\r\n\t\tthis.block_id = block_id;\r\n\t\tthis.signature = signature;\r\n\t\tthis.value = value;\r\n\t\tthis.css_id = css_id;\r\n\t\tthis.section_id = section_id;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass CT {\r\n\r\n\tconstructor(\r\n\r\n\t\tid,\r\n\t\tstatus,\r\n\t\tdetails,\r\n\t\toptions,\r\n\t\tanalysis\r\n\r\n\t) {\r\n\t\tthis.id = id; // class Id\r\n\t\tthis.status = status; // class Status\r\n\t\tthis.details = details; // array of class Detail\r\n\t\tthis.options = options; //array of class Option\r\n\t\tthis.analysis = analysis;\r\n\t}\r\n\r\n\tinitDetailsSignatureData() { // ДАННЫЕ!! Установка данных для поиска в HTML лапше, возвращает массив и длину массива\r\n\r\n\t\tconst values = [\r\n\t\t\t// имя параметра, номер блока, сигнатура, РЕЗЕРВ, стиль, где искать\r\n\t\t\t['sender_email', '0', '<td>email&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['sender_email_is_bl', '0', '<td>email_in_list&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['sender_email_is_sc', '0', '<td>short_cache_email&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['sender_email_is_disp', '0', '<td>mail_domain_one_raz&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['sender_ip', '1', '<td>ip&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['sender_ip_is_bl', '1', '<td>ip_in_list&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['sender_ip_is_sc', '1', '<td>short_cache_ip&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['username', '1', '<td>username&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['message', '1', '<td>message&nbsp;</td>', '', 'DEFAULT', 'params'],\r\n\t\t\t['ct_options', '2', '<td>ct_options&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['ct_agent', '3', '<td>agent&nbsp;</td>', '', 'DEFAULT', 'params'],\r\n\t\t\t['js_status', '4', '<td>js_passed&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['submit_time', '4', '<td>submit_time&nbsp;</td>', '', 'DEFAULT', 'params'],\r\n\t\t\t['cookies_enabled', '4', '<td>cookies_enabled&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['page_referrer', '4', '<td>REFFERRER&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['page_pre_referrer', '4', '<td>REFFERRER_PREVIOUS&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['page_url', '4', '<td>page_url&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['sender_url', '4', '<td>sender_url&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['comment_type', '4', '<td>comment_type&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['hook_type', '4', '<td>hook&nbsp;</td>', '', 'DEFAULT', 'sender'],\r\n\t\t\t['is_greylisted', '4', '<td>grey_list_stop&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['is_mobile_ua', '4', '<td>is_mobile_UA&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['links_detected', '4', '<td>links&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['allowed_by_pl', '4', '<td>private_list_allow&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['denied_by_pl', '4', '<td>private_list_deny&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['pl_has_records', '4', '<td>private_list_detected&nbsp;</td>', '', 'DEFAULT', 'details'],\r\n\t\t\t['is_allowed', '4', '<td>allow&nbsp;</td>', '', 'DEFAULT', 'response'],\r\n\t\t\t['method_name', '4', '<td>method_name&nbsp;</td>', '', 'DEFAULT', 'details']\r\n\t\t];\r\n\r\n//длина массива данных для поиска определена\r\n\t\tpub_details_array_length = values.length;\r\n\r\n\t\treturn values;\r\n\r\n\r\n\t}// ДАННЫЕ!! Установка данных для поиска в HTML лапше, возвращает массив и длину массива\r\n\r\n\tinitDetailsArray() { //создаёт объекты Details в массиве (без values) на основе set_details_signature_data\r\n\r\n\t\tthis.details = [];\r\n\t\tlet details_draft = this.initDetailsSignatureData();\r\n\r\n\t\tfor (let i = 0; i < pub_details_array_length; i++) {\r\n\t\t\tthis.details.push (\r\n\t\t\t\tnew Detail(\r\n\t\t\t\t\t(details_draft[i][0]),\r\n\t\t\t\t\t(details_draft[i][1]),\r\n\t\t\t\t\t(details_draft[i][2]),\r\n\t\t\t\t\t(details_draft[i][3]),\r\n\t\t\t\t\t(details_draft[i][4]),\r\n\t\t\t\t\t(details_draft[i][5])\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t\t//Внесение результатов поиcка values в массив объектов Details\r\n\t\t\tthis.details[i].value = helper.getDetailSignatureForSection(this.details[i].section_id, this.details[i].signature);\r\n\r\n\t\t\t//helper.debugMessage(this.details[i].name +' *** '+ this.details[i].value +' '+this.details[i].css_id);\r\n\t\t\tif (\r\n\t\t\t\tthis.details[i].name === 'sender_email'\r\n\t\t\t\t||\r\n\t\t\t\tthis.details[i].name === 'sender_ip'\r\n\t\t\t){\r\n\t\t\t\tthis.details[i].value =  helper.findBetween(this.details[i].value,'\"_blank\">','</a>');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\t//создаёт объекты Detail в массиве (без values) на основе set_details_signature_data\r\n\r\n\tinitOptionsArray () { \t\t\t\t//создаёт объекты Option в массиве ct.options\r\n\r\n\t\tthis.options = helper.getOptionsFromJSON(this.getDetailValueByName(\"ct_options\"));\r\n\r\n\t}\t//создаёт объекты Option в массиве ct.options TODO Добавить сортировку, сначала выводить изменённые\r\n\r\n\tdrawDetailsBlock() { //рисует блоки основываясь на Section ID\r\n\r\n\t\tlet ar = [];\r\n\r\n\t\tfor (let j = 0; j < pub_details_array_length; j++) {\r\n\t\t\tar.push(parseInt(this.details[j].block_id));\r\n\t\t}\r\n\r\n\t\tconst number_of_blocks = Math.max.apply(null, ar) + 1; \t\t\t\t\t\t//колчество блоков определено\r\n\r\n\t\tfor (let block_id = 0; block_id !== number_of_blocks; block_id++) {\r\n\r\n\t\t\t//helper.addTag('details_table-tbody', 'beforeend', ('<tr id=\"details_tier_block_' + block_id + '\">SECTION ' + block_id + '</tr>')); todo Деление на секции, тут разобратсья нужно оно или нет\r\n\r\n\t\t\tfor (let i = 0; i < pub_details_array_length; i++) { \t\t\t\t\t\t//добавление строк\r\n\r\n\t\t\t\tif (pub_strcnt <= i) { \t\t\t\t\t\t\t\t\t\t\t\t\t\t//хуй знает как это работает и почему без этого не работает\r\n\r\n\t\t\t\t\tlet detail = this.details[pub_strcnt];\r\n\r\n\t\t\t\t\tif (parseInt(detail.block_id) === block_id) { \t\t// добавляем строки если block_id совпал\r\n\r\n\t\t\t\t\t\tif (detail.name !== 'ct_options') { \t\t\t\t//пропускаем блок options\r\n\r\n\t\t\t\t\t\t\thelper.addTag('details_table-tbody', 'beforeend', ('<tr id=\"details_tier_' + pub_strcnt + '\"></tr>'));\r\n\r\n\t\t\t\t\t\t\tif (detail.value !== 'INVISIBLE') {\r\n\t\t\t\t\t\t\t\t//\r\n// Подготовка шаблона ссылки для sender_email и sender_ip\r\n\r\n\t\t\t\t\t\t\t\tlet href = '';\r\n\t\t\t\t\t\t\t\tlet ip_additional_hrefs = '';\r\n\t\t\t\t\t\t\t\tlet email_additional_hrefs = '';\r\n\r\n\t\t\t\t\t\t\t\tif (detail.name === 'sender_ip' || this.details[pub_strcnt].name ==='sender_email') {\r\n\t\t\t\t\t\t\t\t\thref = 'href=https://cleantalk.org/blacklists/'+ this.details[pub_strcnt].value + ' ';\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (detail.name === 'sender_ip'){\r\n\t\t\t\t\t\t\t\t\tip_additional_hrefs = '<a href=\"https://cleantalk.org/noc/requests?sender_ip=' +\r\n\t\t\t\t\t\t\t\t\t\tdetail.value +\r\n\t\t\t\t\t\t\t\t\t\t'\">  [Все запросы с этим IP]  </a><a href=\"https://ipinfo.io/' +\r\n\t\t\t\t\t\t\t\t\t\tdetail.value +\r\n\t\t\t\t\t\t\t\t\t\t'\">  [IPINFO]</a></td>'\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (detail.name === 'sender_email'){\r\n\t\t\t\t\t\t\t\t\temail_additional_hrefs = '<a href=\"https://cleantalk.org/noc/requests?sender_email=' +\r\n\t\t\t\t\t\t\t\t\t\tdetail.value +\r\n\t\t\t\t\t\t\t\t\t\t'\">  [Все запросы с этим EMAIL]  </a><a href=\"https://cleantalk.org/email-checker/' +\r\n\t\t\t\t\t\t\t\t\t\tdetail.value +\r\n\t\t\t\t\t\t\t\t\t\t'\">  [CHECKER]</a></td>'\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\r\n//\r\n// Подсветка параметров\r\n\r\n\t\t\t\t\t\t\t\tswitch (detail.css_id){\r\n\t\t\t\t\t\t\t\t\t//по умолчанию чёрный\r\n\t\t\t\t\t\t\t\t\tcase 'DEFAULT':{\r\n\t\t\t\t\t\t\t\t\t\thelper.addTag(('details_tier_' + pub_strcnt),\r\n\t\t\t\t\t\t\t\t\t\t\t'beforeend',\r\n\t\t\t\t\t\t\t\t\t\t\t('<td class=\"details-name\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ detail.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ ':</td>'));\r\n\t\t\t\t\t\t\t\t\t\thelper.addTag(\r\n\t\t\t\t\t\t\t\t\t\t\t('details_tier_' + pub_strcnt),\r\n\t\t\t\t\t\t\t\t\t\t\t'beforeend',\r\n\t\t\t\t\t\t\t\t\t\t\t('<td class=\"details-value\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ detail.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '</a>'+ ip_additional_hrefs\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ email_additional_hrefs +'</td>'));\r\n\t\t\t\t\t\t\t\t\t} break;\r\n\t\t\t\t\t\t\t\t\t//плохой - красный\r\n\t\t\t\t\t\t\t\t\tcase 'BAD':{\r\n\r\n\t\t\t\t\t\t\t\t\t\thelper.addTag(('details_tier_' + pub_strcnt),\r\n\t\t\t\t\t\t\t\t\t\t\t'beforeend',\r\n\t\t\t\t\t\t\t\t\t\t\t('<td class=\"details-name\"><a style=\"color:#C02000\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ detail.name + ':</td>'));\r\n\r\n\t\t\t\t\t\t\t\t\t\thelper.addTag(\r\n\t\t\t\t\t\t\t\t\t\t\t('details_tier_' + pub_strcnt),\r\n\t\t\t\t\t\t\t\t\t\t\t'beforeend',\r\n\t\t\t\t\t\t\t\t\t\t\t('<td class=\"details-value\"><a '+href+'style=\"color:#C02000\">' +\r\n\t\t\t\t\t\t\t\t\t\t\t\tdetail.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '</a>'+ ip_additional_hrefs\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ email_additional_hrefs\r\n\t\t\t\t\t\t\t\t\t\t\t\t+'</td>'));\r\n\r\n\t\t\t\t\t\t\t\t\t} break;\r\n\t\t\t\t\t\t\t\t\t//хорошиий - зелёный\r\n\t\t\t\t\t\t\t\t\tcase 'GOOD':{\r\n\r\n\t\t\t\t\t\t\t\t\t\thelper.addTag(('details_tier_' + pub_strcnt),\r\n\t\t\t\t\t\t\t\t\t\t\t'beforeend',\r\n\t\t\t\t\t\t\t\t\t\t\t('<td class=\"details-name\"><a style=\"color:#009000\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ detail.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ ':</a></td>'));\r\n\r\n\t\t\t\t\t\t\t\t\t\thelper.addTag(\r\n\t\t\t\t\t\t\t\t\t\t\t('details_tier_' + pub_strcnt),\r\n\t\t\t\t\t\t\t\t\t\t\t'beforeend',\r\n\t\t\t\t\t\t\t\t\t\t\t('<td class=\"details-value\"><a '\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ href\r\n\t\t\t\t\t\t\t\t\t\t\t\t+'style=\"color:#009000\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ detail.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '</a>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ ip_additional_hrefs\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ email_additional_hrefs +'</td>'));\r\n\r\n\t\t\t\t\t\t\t\t\t} break;\r\n\t\t\t\t\t\t\t\t\t//некорректный - бордовый\r\n\t\t\t\t\t\t\t\t\tcase 'INCORRECT':{\r\n\r\n\t\t\t\t\t\t\t\t\t\thelper.addTag(('details_tier_' + pub_strcnt),\r\n\t\t\t\t\t\t\t\t\t\t\t'beforeend',\r\n\t\t\t\t\t\t\t\t\t\t\t('<td class=\"details-name\"><a style=\"color:#CC0000\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ detail.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ ':</a></td>'));\r\n\r\n\t\t\t\t\t\t\t\t\t\thelper.addTag(\r\n\t\t\t\t\t\t\t\t\t\t\t('details_tier_' + pub_strcnt),\r\n\t\t\t\t\t\t\t\t\t\t\t'beforeend',\r\n\t\t\t\t\t\t\t\t\t\t\t('<td class=\"details-value\"><a style=\"color:#CC0000\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ detail.value\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '</a>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ ip_additional_hrefs\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ email_additional_hrefs\r\n\t\t\t\t\t\t\t\t\t\t\t\t+'</td>'));\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n//\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpub_strcnt++; //счётчик строк увеличен в конце цикла\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}// рисует блоки Details основываясь на Section ID из set_details_signature_data\r\n\r\n\tdrawOptionsBlock() { // рисует блок опций\r\n\r\n\t\tpub_strcnt = 0;\r\n\r\n\t\thelper.addTag('options_table-tbody', 'beforeend', ('<tr id=\"options_tier_block></tr>'));\r\n\r\n\t\tfor (let i = 0; i < this.options.length; i++) { //добавление строк\r\n\r\n\t\t\tif (pub_strcnt <= i) { //хуй знает как это работает и почему без этого не работает\r\n\r\n\t\t\t\thelper.addTag('options_table-tbody', 'beforeend', ('<tr id=\"options_tier_' + pub_strcnt + '\"></tr>'));\r\n\t\t\t\thelper.addTag(('options_tier_' + pub_strcnt), 'beforeend', ('<td class=\"options-name\">' + this.options[pub_strcnt].name + ':</td>'));\r\n\t\t\t\thelper.addTag(('options_tier_' + pub_strcnt), 'beforeend', ('<td class=\"options-value\">' + this.options[pub_strcnt].value + '</td>'));\r\n\r\n\t\t\t\tpub_strcnt++;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} // рисует блок опций\r\n\r\n\tdrawStatusBlock(){\r\n\r\n\t\tif (ct.status.filters != null) { // Подсветка фильтров с правками если фильтры вообще есть\r\n\t\t\tlet service_or_user_id = '';\r\n\t\t\tif (ct.status.filters.includes('service_') || ct.status.filters.includes('user_')) {\r\n\t\t\t\tlet start = '-';\r\n\t\t\t\tlet id_regexp;\r\n\t\t\t\tfor (let i = 0; i < ct.status.filters.length; i++) {\r\n\t\t\t\t\tif (((ct.status.filters.slice(i, i + 8)) === 'service_') || ((ct.status.filters.slice(i, i + 5)) === 'user_')) {\r\n\t\t\t\t\t\tstart = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (start !== '-') {\r\n\t\t\t\t\t\tif (ct.status.filters[i] === ':') {\r\n\t\t\t\t\t\t\tlet end = i;\r\n\t\t\t\t\t\t\tif (start != '-' && end != '-') {\r\n\t\t\t\t\t\t\t\tservice_or_user_id = ct.status.filters.slice(start, end)\r\n\t\t\t\t\t\t\t\tid_regexp = new RegExp(service_or_user_id, 'gi');\r\n\t\t\t\t\t\t\t\tend = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tstart = '-';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tct.status.filters = ct.status.filters.replace(id_regexp, `<a style=\"color:#990000\">` + service_or_user_id + `</a>`);\r\n\t\t\t\thelper.addToIssuesList('Для пользователя правились фильтры.','0');\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlayout_window.document.getElementById('status_table-filter-raw').innerHTML += (\r\n\t\t\t\t'Агент: [' + ct.status.agent + '] Фильтры: [' + ct.status.filters + ']'\r\n\t\t\t);\r\n\t\t\tlayout_window.document.getElementById('layout_window_title').innerHTML += (' [' + ct.id.value + '] [' + ct.status.isAllowed + ']'); //todo менять цвет в зависимости от состояния\r\n\t\t}\r\n\t} // рисует блок статуса\r\n\r\n\tgetDetailValueByName(name) { \t//вызывает значения value объекта Detail по имени\r\n\r\n\t\tfor (let i = 0; i < pub_details_array_length; i++) {\r\n\r\n\t\t\tif (this.details[i].name === name) {\r\n\t\t\t\treturn this.details[i].value\r\n\t\t\t}\r\n\t\t}\r\n\t} //вызывает значения value объекта Detail по имени\r\n\r\n\tsetDetailPropertyByName(detail_name, property, new_value) { \t//вызывает значения value объекта Detail по имени\r\n\r\n\t\tfor (let i = 0; i < pub_details_array_length; i++) {\r\n\r\n\t\t\tif (this.details[i].name === detail_name) {\r\n\r\n\t\t\t\tswitch (property) {\r\n\r\n\t\t\t\t\tcase 'css_id':{\r\n\t\t\t\t\t\tthis.details[i].css_id = new_value;\r\n\t\t\t\t\t} break;\r\n\r\n\t\t\t\t\tcase 'value':{\r\n\t\t\t\t\t\tthis.details[i].value = new_value;\r\n\t\t\t\t\t} break;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t} //вызывает значения value объекта Detail по имени\r\n\r\n\r\n\r\n}\r\n\r\nclass Option {\r\n\r\n\tconstructor(\r\n\t\tname,\r\n\t\tvalue,\r\n\t\tpriority,\r\n\t) {\r\n\r\n\t\tthis.name = name;\r\n\t\tthis.value = value;\r\n\t\tthis.priority = priority;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass Analysis {\r\n\r\n\tconstructor(\r\n\r\n\t\toptions_default,\r\n\r\n\t) {\r\n\r\n\t\tthis.options_default = options_default;\r\n\r\n\t}\r\n\r\n\r\n\r\n\r\n\t//todo не отрабатывает post_info для comment type\r\n\r\n\tinitOptionsDefaults() { \t\t\t//устанавлвает опции по умолчанию\r\n\r\n\t\tthis.options_default = { // объект опций\r\n\t\t\twordpress: '',\r\n\t\t\tdrupal: '',\r\n\t\t\tjoomla: '',\r\n\t\t}\r\n\t\t//берёт массив опций из JSON\r\n\t\tthis.options_default.wordpress = helper.getOptionsFromJSON('{\"spam_firewall\":\"1\",\"sfw__anti_flood\":\"1\",\"sfw__anti_flood__view_limit\":\"20\",\"sfw__anti_crawler\":\"1\",\"sfw__anti_crawler_ua\":\"1\",\"apikey\":\"9arymagatetu\",\"autoPubRevelantMess\":\"0\",\"registrations_test\":\"1\",\"comments_test\":\"1\",\"contact_forms_test\":\"1\",\"general_contact_forms_test\":\"1\",\"wc_checkout_test\":\"1\",\"wc_register_from_order\":\"1\",\"search_test\":\"1\",\"check_external\":\"0\",\"check_external__capture_buffer\":\"0\",\"check_internal\":\"0\",\"disable_comments__all\":\"0\",\"disable_comments__posts\":\"0\",\"disable_comments__pages\":\"0\",\"disable_comments__media\":\"0\",\"bp_private_messages\":\"1\",\"check_comments_number\":\"1\",\"remove_old_spam\":\"0\",\"remove_comments_links\":\"0\",\"show_check_links\":\"1\",\"manage_comments_on_public_page\":\"0\",\"protect_logged_in\":\"1\",\"use_ajax\":\"1\",\"use_static_js_key\":\"-1\",\"general_postdata_test\":\"0\",\"set_cookies\":\"1\",\"set_cookies__sessions\":\"0\",\"ssl_on\":\"0\",\"use_buitin_http_api\":\"1\",\"exclusions__urls\":\"\",\"exclusions__urls__use_regexp\":\"0\",\"exclusions__fields\":\"\",\"exclusions__fields__use_regexp\":\"0\",\"exclusions__roles\":[\"Administrator\"],\"show_adminbar\":\"1\",\"all_time_counter\":\"0\",\"daily_counter\":\"0\",\"sfw_counter\":\"0\",\"user_token\":\"\",\"collect_details\":\"0\",\"send_connection_reports\":\"0\",\"async_js\":\"0\",\"debug_ajax\":\"0\",\"gdpr_enabled\":\"0\",\"gdpr_text\":\"\",\"store_urls\":\"1\",\"store_urls__sessions\":\"1\",\"comment_notify\":\"1\",\"comment_notify__roles\":[],\"complete_deactivation\":\"0\",\"dashboard_widget__show\":\"1\",\"allow_custom_key\":\"0\",\"allow_custom_settings\":\"0\",\"white_label\":\"0\",\"white_label__hoster_key\":\"\",\"white_label__plugin_name\":\"\",\"use_settings_template\":\"0\",\"use_settings_template_apply_for_new\":\"0\",\"use_settings_template_apply_for_current\":\"0\",\"use_settings_template_apply_for_current_list_sites\":\"\"}');\r\n\r\n\t}\r\n\r\n\tcompareCtOptionsWithDefaults(def_options_agent) { //сравнение опций из запроса с опциями по умолчанию\r\n\r\n\t\tlet changes_array = [];\r\n\t\tif (def_options_agent.length === ct.options.length) { //todo убрать этот блок, оставить только проверку по именам поций\r\n\r\n\t\t} else {\r\n\t\t}\r\n\r\n\r\n\r\n\t\tfor (let i = 0; i <= def_options_agent.length - 1; i++) {\r\n\r\n\t\t\tconst def_value = helper.trimAndLow(def_options_agent[i].value);\r\n\r\n\t\t\tfor (let j = 0; j<= ct.options.length -1; j++) {\r\n\r\n\t\t\t\tconst req_value = helper.trimAndLow(ct.options[j].value);\r\n\r\n\t\t\t\tif ( (def_options_agent[i].name === ct.options[j].name) && ( def_value !== req_value )) {\r\n\r\n\t\t\t\t\tchanges_array.push(j);\r\n\t\t\t\t\thelper.addToChangedOptionsList(ct.options[j].name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tchanges_array.forEach(function (value) { // подсветка изменённых опций\r\n\t\t\tlet tr_name = ('options_tier_' + value);\r\n\t\t\tlayout_window.document.getElementById(tr_name).style.color = '#FF0000';\r\n\t\t})\r\n\t\tlayout_window.document.getElementById('options_header').innerHTML += ('<a style = \"color: red\"> (' + changes_array.length + ')</a>');\r\n\r\n\t\treturn changes_array;\r\n\t} //сравнение опций по умолчанию с текущими\r\n\r\n\tcheckOptions() { // проверяет опции по умолчанию, вызывая check_options_comparison для кейсов по агенту\r\n\t\t//todo Дублирование опций обойти https://cleantalk.org/noc/requests?request_id=460ecc492b54f98b5b5bbf26a3629848\r\n\t\tif (ct.status.agent.includes('wordpress')) {\r\n\t\t\tthis.compareCtOptionsWithDefaults(this.options_default.wordpress);\r\n\t\t}\r\n\t\t//тут будут другие агенты\r\n\t}\r\n\r\n\tcheckDetails() {\r\n\r\n\t\tfor (let i=0; i<=ct.details.length-1; i++){\r\n\t\t\tlet detail = ct.details[i];\r\n\t\t\tswitch (detail.name) {\r\n\r\n\t\t\t\t//SHORTCACHE\r\n\r\n\t\t\t\tcase 'sender_email_is_sc': {\r\n\r\n\t\t\t\t\tif (Number(detail.value) >= 30) {\r\n\r\n\t\t\t\t\t\tdetail.css_id = 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('EMAIL в шорткэше', '0');\r\n\r\n\t\t\t\t\t} else detail.value = 'INVISIBLE';\r\n\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\tcase 'sender_ip_is_sc': {\r\n\r\n\t\t\t\t\tif (Number(detail.value) >= 30) {\r\n\r\n\t\t\t\t\t\tdetail.css_id = 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('IP в шорткэше', '0');\r\n\r\n\t\t\t\t\t} else detail.value = 'INVISIBLE';\r\n\r\n\t\t\t\t} break;\r\n\r\n\r\n\t\t\t\t//EMAIL\r\n\t\t\t\tcase 'sender_email': {\r\n\r\n\t\t\t\t\tif (detail.value === '') {\r\n\r\n\t\t\t\t\t\tdetail.css_id = 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('EMAIL передан, но пустой', '3');\r\n\r\n\t\t\t\t\t} else if (detail.value === null) {\r\n\r\n\t\t\t\t\t\tdetail.css_id = 'INCORRECT';\r\n\t\t\t\t\t\thelper.addToIssuesList('Не смогли определить EMAIL', '10');\r\n\r\n\t\t\t\t\t} else if (ct.getDetailValueByName('sender_email_is_bl')==2){\r\n\r\n\t\t\t\t\t\tdetail.css_id = 'BAD';\r\n\r\n\t\t\t\t\t} else detail.css_id = 'GOOD';\r\n\r\n\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t//JS\r\n\t\t\t\tcase 'js_status': {\r\n\r\n\t\t\t\t\tif (Number(detail.value) === -1){\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('JS отключен в браузере', '3');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse if (Number(detail.value) === 1){\r\n\t\t\t\t\t\tdetail.css_id= 'GOOD';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse if(Number(detail.value) === 0){\r\n\t\t\t\t\t\tdetail.css_id= 'BAD'\r\n\t\t\t\t\t\thelper.addToIssuesList('Тест JS провален', '3');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdetail.css_id= 'INCORRECT';\r\n\t\t\t\t\t\thelper.addToIssuesList('Не смогли определить JS', '10');\r\n\t\t\t\t\t}\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t//IP\r\n\t\t\t\tcase 'sender_ip': {\r\n\r\n\t\t\t\t\tif (detail.value === '') {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('IP адрес пустой', '3');\r\n\r\n\t\t\t\t\t} else if (detail.value === null) {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'INCORRECT';\r\n\t\t\t\t\t\thelper.addToIssuesList('Не смогли определить IP адрес', '10');\r\n\r\n\t\t\t\t\t} else if (ct.getDetailValueByName('sender_ip_is_bl')==2){\r\n\r\n\t\t\t\t\t\tdetail.css_id = 'BAD';\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse detail.css_id= 'GOOD';\r\n\r\n\t\t\t\t}break;\r\n\r\n\t\t\t\t//REFERRER\r\n\t\t\t\tcase 'page_referrer': {\r\n\r\n\t\t\t\t\tif (detail.value === '') {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('REFERRER  пустой', '3');\r\n\r\n\t\t\t\t\t} else if (detail.value.includes('google')) {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('Поисковик в REFERRER', '10');\r\n\r\n\t\t\t\t\t}  else detail.css_id= 'GOOD';\r\n\r\n\t\t\t\t}break;\r\n\r\n\t\t\t\t//PRE-REFERRER\r\n\t\t\t\tcase 'page_pre_referrer': {\r\n\r\n\t\t\t\t\tif (detail.value === '') {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('PRE-REFERRER  пустой', '3');\r\n\r\n\t\t\t\t\t} else if (detail.value.includes('google')) {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('Поисковик в PRE-REFERRER', '10');\r\n\r\n\t\t\t\t\t}  else detail.css_id= 'GOOD';\r\n\r\n\t\t\t\t}break;\r\n\r\n\t\t\t\t//SUBMIT_TIME\r\n\t\t\t\tcase 'submit_time': {\r\n\r\n\t\t\t\t\tif ( detail.value === undefined || detail.value === '' ){\r\n\t\t\t\t\t\tdetail.css_id= 'INCORRECT';\r\n\t\t\t\t\t\thelper.addToIssuesList('Не смогли определить SUBMIT_TIME.', '10');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse if (Number(detail.value) === 0){\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('SUBMIT_TIME = 0. Возможен GREYLISTING', '5');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse if(Number(detail.value) === 1){\r\n\t\t\t\t\t\tdetail.css_id= 'INCORRECT'\r\n\t\t\t\t\t\thelper.addToIssuesList('SUBMIT_TIME = 1, так быть не должно. Делай тест.', '10');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse if(1 <= Number(detail.value) && Number(detail.value <= 5) ){\r\n\t\t\t\t\t\tdetail.css_id= 'BAD'\r\n\t\t\t\t\t\thelper.addToIssuesList('1 <= SUBMIT_TIME < 5, слишком низкий.', '3');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse if(500 <= Number(detail.value) && Number(detail.value) <= 3000){\r\n\t\t\t\t\t\tdetail.css_id= 'BAD'\r\n\t\t\t\t\t\thelper.addToIssuesList('3000 > SUBMIT_TIME > 500, многовато.', '3');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse if(Number(detail.value) > 3000){\r\n\t\t\t\t\t\tdetail.css_id= 'BAD'\r\n\t\t\t\t\t\thelper.addToIssuesList('SUBMIT_TIME > 3000, есть проблемы.', '3');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdetail.css_id= 'GOOD';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t//COOKIES\r\n\t\t\t\tcase 'cookies_enabled': {\r\n\r\n\t\t\t\t\tif (detail.value === '' ||\r\n\t\t\t\t\t\tdetail.value === null) {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('Не смогли определить наличие COOKIES', '3');\r\n\r\n\t\t\t\t\t} else if (detail.value == 0){\r\n\r\n\t\t\t\t\t\tdetail.css_id = 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('COOKIES отключены', '10');\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse detail.css_id= 'GOOD';\r\n\r\n\t\t\t\t}break;\r\n\r\n\t\t\t\t//GREYLIST\r\n\t\t\t\tcase 'is_greylisted': {\r\n\r\n\t\t\t\t\tif (detail.value == 1) {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('Сработал GREYLIST. Смотри SUBMIT_TIME.', '3');\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse detail.value= 'INVISIBLE';\r\n\r\n\t\t\t\t}break;\r\n\r\n\t\t\t\t//MOBILE_UA\r\n\t\t\t\tcase 'is_mobile_ua': {\r\n\r\n\t\t\t\t\tif (detail.value == 1) {\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'GOOD';\r\n\t\t\t\t\t\thelper.addToIssuesList('USERAGENT - мобильное устройство', '0');\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse detail.value= 'INVISIBLE';\r\n\r\n\t\t\t\t}break;\r\n\r\n\t\t\t\t//PAGE_URL\r\n\t\t\t\tcase 'page_url': {\r\n\r\n\t\t\t\t\tif (detail.value.includes('members') ||\r\n\t\t\t\t\t\t//detail.value.includes('') ||\r\n\t\t\t\t\t\tdetail.value.includes('admin') ||\r\n\t\t\t\t\t\tdetail.value.includes('login')\r\n\t\t\t\t\t){\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('Возможен перехват админки, смотри PAGE_URL', '0');\r\n\r\n\t\t\t\t\t} else if(detail.value == '' ||\r\n\t\t\t\t\t\tdetail.value === null\r\n\t\t\t\t\t){\r\n\r\n\t\t\t\t\t\tdetail.css_id= 'BAD';\r\n\t\t\t\t\t\thelper.addToIssuesList('Пустой PAGE_URL. Это странно.', '0');\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse detail.css_id= 'GOOD';\r\n\r\n\t\t\t\t}break;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//==== TEST BLOCK\r\n\r\n//==== TEST BLOCK END\r\n\r\n//==== DECLARE BLOCK\r\nconst CURRENT_VERSIONS = new Map(\r\n\t[\r\n\t\t['wordpress','wordpress-51514']\r\n\t]\r\n)\r\nlet extracted_html;\r\nlet pub_ip_trimmed;\r\nlet pub_details_array_length;\r\nlet ct = new CT();\r\nct.id = new Id();\r\nct.analysis = new Analysis();\r\nct.status = new Status();\r\n\r\nhelper = new Helper();\r\nhelper.initHelperData();\r\n\r\n//==== DECLARE BLOCK END\r\n\r\n//==== LISTENERS\r\nchrome.runtime.onMessage.addListener(function (message) {\r\n\tswitch (message.command) {\r\n\r\n\t\tcase \"pageHtml\":\r\n\t\t\textracted_html = message.html;\r\n\t\t\thelper.callWindow();\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tbreak;\r\n\t}\r\n})\r\n\r\nfunction logHtmlCode(tab) {\r\n\tchrome.tabs.executeScript(tab.id, {file: \"send-page-code.js\"});\r\n}\r\n\r\nchrome.browserAction.onClicked.addListener(logHtmlCode);\r\n//==== LISTENERS END\r\n//CODE END\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- LARQA/background.js	(revision 6e2cab2153d9ec9c144e59a9d524b26c5d4c9d89)
+++ LARQA/background.js	(date 1611045849945)
@@ -2,6 +2,7 @@
 //todo Допилить проверку параметров
 //todo Допилить статус, отображать одобрен\нет, менять цвет в зависимости от этого, отражать allowed by PL
 
+
 class Helper{
 
 	constructor(
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"AnalysisUIOptions\">\r\n    <option name=\"SCOPE_TYPE\" value=\"10\" />\r\n  </component>\r\n  <component name=\"BranchesTreeState\">\r\n    <expand>\r\n      <path>\r\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\r\n        <item name=\"LOCAL_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\r\n      </path>\r\n      <path>\r\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\r\n        <item name=\"REMOTE_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\r\n      </path>\r\n      <path>\r\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\r\n        <item name=\"REMOTE_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\r\n        <item name=\"GROUP_NODE:origin\" type=\"e8cecc67:BranchNodeDescriptor\" />\r\n      </path>\r\n    </expand>\r\n    <select />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"511d5316-a028-4c31-b999-692524fa7b16\" name=\"Default Changelist\" comment=\"\">\r\n      <change beforePath=\"$PROJECT_DIR$/LARQA/background.js\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/LARQA/background.js\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"ComposerSettings\">\r\n    <execution />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"HTML File\" />\r\n        <option value=\"JavaScript File\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <favorite-branches>\r\n      <branch-storage>\r\n        <map>\r\n          <entry type=\"REMOTE\">\r\n            <value>\r\n              <list>\r\n                <branch-info repo=\"$PROJECT_DIR$\" source=\"origin/dev\" />\r\n              </list>\r\n            </value>\r\n          </entry>\r\n        </map>\r\n      </branch-storage>\r\n    </favorite-branches>\r\n    <option name=\"RECENT_BRANCH_BY_REPOSITORY\">\r\n      <map>\r\n        <entry key=\"$PROJECT_DIR$\" value=\"dev\" />\r\n      </map>\r\n    </option>\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"ProblemsViewState\">\r\n    <hideBySeverity>\r\n      <option value=\"15\" />\r\n    </hideBySeverity>\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"1jdWdQ6MJIFn3UlOn18QftbyzfG\" />\r\n  <component name=\"ProjectLevelVcsManager\">\r\n    <ConfirmationsSetting value=\"2\" id=\"Add\" />\r\n  </component>\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">\r\n    <property name=\"ASKED_ADD_EXTERNAL_FILES\" value=\"true\" />\r\n    <property name=\"DefaultHtmlFileTemplate\" value=\"HTML File\" />\r\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.ShowReadmeOnStart\" value=\"true\" />\r\n    <property name=\"WebServerToolWindowFactoryState\" value=\"false\" />\r\n    <property name=\"last_opened_file_path\" value=\"$PROJECT_DIR$\" />\r\n    <property name=\"node.js.detected.package.eslint\" value=\"true\" />\r\n    <property name=\"node.js.detected.package.tslint\" value=\"true\" />\r\n    <property name=\"node.js.path.for.package.eslint\" value=\"project\" />\r\n    <property name=\"node.js.path.for.package.tslint\" value=\"project\" />\r\n    <property name=\"node.js.selected.package.eslint\" value=\"(autodetect)\" />\r\n    <property name=\"node.js.selected.package.tslint\" value=\"(autodetect)\" />\r\n    <property name=\"run.code.analysis.last.selected.profile\" value=\"pProject Default\" />\r\n    <property name=\"settings.editor.selected.configurable\" value=\"preferences.keymap\" />\r\n    <property name=\"vue.rearranger.settings.migration\" value=\"true\" />\r\n  </component>\r\n  <component name=\"RecentsManager\">\r\n    <key name=\"CopyFile.RECENT_KEYS\">\r\n      <recent name=\"C:\\Users\\Александр\\Documents\\MEGAsync\\larqa\\gitcopy\\LARQA\" />\r\n    </key>\r\n  </component>\r\n  <component name=\"RunManager\">\r\n    <configuration name=\"background.js\" type=\"NodeJSConfigurationType\" temporary=\"true\" nameIsGenerated=\"true\" path-to-js-file=\"$PROJECT_DIR$/LARQA/background.js\" working-dir=\"$PROJECT_DIR$/LARQA\">\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <recent_temporary>\r\n      <list>\r\n        <item itemvalue=\"Node.js.background.js\" />\r\n      </list>\r\n    </recent_temporary>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" BundledDictionaries=\"0\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" Dictionaries=\"0\" CorrectionsLimit=\"5\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" />\r\n  <component name=\"SvnConfiguration\">\r\n    <configuration />\r\n  </component>\r\n  <component name=\"TaskManager\">\r\n    <task id=\"Default\" summary=\"Default task\">\r\n      <branch name=\"dev\" repository=\"D:\\Megadisk\\larqa\\gitcopy\" original=\"true\" />\r\n      <changelist id=\"511d5316-a028-4c31-b999-692524fa7b16\" name=\"Default Changelist\" comment=\"\" />\r\n      <created>1604134535335</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1604254471446</updated>\r\n      <workItem from=\"1604134536468\" duration=\"25593000\" />\r\n      <workItem from=\"1604213951006\" duration=\"27407000\" />\r\n    </task>\r\n    <task id=\"LOCAL-00001\" summary=\"transfer 6 months changes to GIT\">\r\n      <created>1604134682357</created>\r\n      <option name=\"number\" value=\"00001\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604134682357</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00002\" summary=\"transfer 6 months changes to GIT\">\r\n      <created>1604139553436</created>\r\n      <option name=\"number\" value=\"00002\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604139553436</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00003\" summary=\"removed OLD folder\">\r\n      <created>1604140834694</created>\r\n      <option name=\"number\" value=\"00003\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604140834694</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00004\" summary=\"- перенёс конструктор блоков HTML в класс Ct_request&#10;- рефакторинг некоторых названий и переменных&#10;- избавился от setdata.js и layout .js\">\r\n      <created>1604172362109</created>\r\n      <option name=\"number\" value=\"00004\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604172362109</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00005\" summary=\"-мигрировал всё на модальное окно из расширения&#10;- убрал мусор\">\r\n      <created>1604252828443</created>\r\n      <option name=\"number\" value=\"00005\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604252828443</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00006\" summary=\"- версировал файлы\">\r\n      <created>1604252870133</created>\r\n      <option name=\"number\" value=\"00006\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604252870133</updated>\r\n    </task>\r\n    <task active=\"true\" id=\"LOCAL-00007\" summary=\"CURRENT\">\r\n      <branch name=\"dev\" repository=\"D:\\Megadisk\\larqa\\gitcopy\" />\r\n      <changelist id=\"511d5316-a028-4c31-b999-692524fa7b16\" name=\"Default Changelist\" comment=\"\" />\r\n      <created>1604254444639</created>\r\n      <option name=\"number\" value=\"00007\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00007\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604254471446</updated>\r\n      <workItem from=\"1604254472083\" duration=\"347000\" />\r\n      <workItem from=\"1604306045214\" duration=\"5698000\" />\r\n      <workItem from=\"1604377790985\" duration=\"7148000\" />\r\n      <workItem from=\"1604654240579\" duration=\"49357000\" />\r\n      <workItem from=\"1604909412343\" duration=\"57117000\" />\r\n      <workItem from=\"1606284307013\" duration=\"4498000\" />\r\n      <workItem from=\"1610429510145\" duration=\"21000\" />\r\n      <workItem from=\"1610429572428\" duration=\"169000\" />\r\n      <workItem from=\"1610430016117\" duration=\"58000\" />\r\n      <workItem from=\"1610430088063\" duration=\"13938000\" />\r\n      <workItem from=\"1610535513450\" duration=\"14960000\" />\r\n      <workItem from=\"1610606240104\" duration=\"2972000\" />\r\n      <workItem from=\"1610624796123\" duration=\"10445000\" />\r\n      <workItem from=\"1610943539998\" duration=\"16283000\" />\r\n      <workItem from=\"1610963158787\" duration=\"10903000\" />\r\n    </task>\r\n    <task id=\"LOCAL-00008\" summary=\"- передалал туду листы\">\r\n      <created>1604254763003</created>\r\n      <option name=\"number\" value=\"00008\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00008\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604254763003</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00009\" summary=\"додела коассс статус начал options через JSON\">\r\n      <created>1604772087901</created>\r\n      <option name=\"number\" value=\"00009\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00009\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604772087901</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00010\" summary=\"- убрал отдельное окно для опций, буду делать всё в одном блоке&#10;&#10;- занимался вёрсткой prefilled\">\r\n      <created>1604856631854</created>\r\n      <option name=\"number\" value=\"00010\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00010\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604856631854</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00011\" summary=\"- запилил таблицу options во второй ряд&#10;- запилил shift+a как горячую клавишу вызова окна\">\r\n      <created>1604984205388</created>\r\n      <option name=\"number\" value=\"00011\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00011\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1604984205388</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00012\" summary=\"- запилил таблицу options во второй ряд&#10;- запилил shift+a как горячую клавишу вызова окна&#10;-запилил класс аналитики, метод проверки опций по умолчанию\">\r\n      <created>1605030061480</created>\r\n      <option name=\"number\" value=\"00012\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00012\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1605030061480</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00013\" summary=\"- обернул проверку дефолтных опций в функцию&#10;&#10;- добавил окрашивание отличающихся опций\">\r\n      <created>1605080657468</created>\r\n      <option name=\"number\" value=\"00013\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00013\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1605080657468</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00014\" summary=\"- добавил подсветку кастомных множеств\">\r\n      <created>1606284551870</created>\r\n      <option name=\"number\" value=\"00014\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00014\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1606284551870</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00015\" summary=\"- добавил подсветку кастомных множеств\">\r\n      <created>1606284620917</created>\r\n      <option name=\"number\" value=\"00015\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00015\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1606284620917</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00016\" summary=\"- добавил подсветку кастомных множеств\">\r\n      <created>1606284688059</created>\r\n      <option name=\"number\" value=\"00016\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00016\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1606284688059</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00017\" summary=\"- добавил подсветку кастомных множеств (правки)\">\r\n      <created>1606284817917</created>\r\n      <option name=\"number\" value=\"00017\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00017\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1606284817917</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00018\" summary=\"Refacotred commit\">\r\n      <created>1610430176398</created>\r\n      <option name=\"number\" value=\"00018\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00018\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1610430176398</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00019\" summary=\"сделал обход при несовпадении количества опций в агенте\">\r\n      <created>1610520530822</created>\r\n      <option name=\"number\" value=\"00019\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00019\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1610520530822</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00020\" summary=\"Правки в подсветке опций\">\r\n      <created>1610525730850</created>\r\n      <option name=\"number\" value=\"00020\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00020\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1610525730850</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00021\" summary=\"Новое:&#10;- запилил функцию поиска между строками в строке find_between&#10;- продолжил логику аналитики (есть проблемы с параметрами)\">\r\n      <created>1610628389302</created>\r\n      <option name=\"number\" value=\"00021\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00021\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1610628389302</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00022\" summary=\"//todo перенести в класс Helper внеклассовые методы, начать с ISSUES&#10;// останавливаю разработку до наведения порядка в коде&#10;// нет поля username...\">\r\n      <created>1610952745615</created>\r\n      <option name=\"number\" value=\"00022\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00022\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1610952745616</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00023\" summary=\"-find_between moved to helper&#10;-debugger refractored\">\r\n      <created>1610953528392</created>\r\n      <option name=\"number\" value=\"00023\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00023\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1610953528392</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00024\" summary=\"Новое:&#10;- убрал все неклассовые методы в класс Helper&#10;- рефакторинг кода, привёл все методы к каноническому виду&#10;- сделал issueslist как в debugMessages - новой строкой в таблицу status\">\r\n      <created>1610963278586</created>\r\n      <option name=\"number\" value=\"00024\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00024\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1610963278586</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00025\" summary=\"Новое:&#10;- вывел message и username в блок details\">\r\n      <created>1611042926995</created>\r\n      <option name=\"number\" value=\"00025\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00025\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1611042926995</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00026\" summary=\"Новое:&#10;- вывожу изменения опций и параметров в соответствующих блоках\">\r\n      <created>1611045718905</created>\r\n      <option name=\"number\" value=\"00026\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00026\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1611045718905</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"27\" />\r\n    <option name=\"createChangelist\" value=\"false\" />\r\n    <option name=\"createBranch\" value=\"false\" />\r\n    <option name=\"useBranch\" value=\"true\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"2\" />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n    <option name=\"oldMeFiltersMigrated\" value=\"true\" />\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <MESSAGE value=\"transfer 6 months changes to GIT\" />\r\n    <MESSAGE value=\"removed OLD folder\" />\r\n    <MESSAGE value=\"- перенёс конструктор блоков HTML в класс Ct_request&#10;- рефакторинг некоторых названий и переменных\" />\r\n    <MESSAGE value=\"- перенёс конструктор блоков HTML в класс Ct_request&#10;- рефакторинг некоторых названий и переменных&#10;- избавился от setdata.js и layout .js\" />\r\n    <MESSAGE value=\"-мигрировал всё на модальное окно из расширения&#10;- убрал мусор\" />\r\n    <MESSAGE value=\"- версировал файлы\" />\r\n    <MESSAGE value=\"- передалал туду листы\" />\r\n    <MESSAGE value=\"додела коассс статус начал options через JSON\" />\r\n    <MESSAGE value=\"- убрал отдельное окно для опций, буду делать всё в одном блоке&#10;&#10;- занимался вёрсткой prefilled\" />\r\n    <MESSAGE value=\"- запилил таблицу options во второй ряд&#10;- запилил shift+a как горячую клавишу вызова окна\" />\r\n    <MESSAGE value=\"- запилил таблицу options во второй ряд&#10;- запилил shift+a как горячую клавишу вызова окна&#10;-запилил класс аналитики, метод проверки опций по умолчанию\" />\r\n    <MESSAGE value=\"- обернул проверку дефолтных опций в функцию&#10;&#10;- добавил окрашивание отличающихся опций\" />\r\n    <MESSAGE value=\"- добавил подсветку кастомных множеств\" />\r\n    <MESSAGE value=\"- добавил подсветку кастомных множеств (правки)\" />\r\n    <MESSAGE value=\"Refacotred commit\" />\r\n    <MESSAGE value=\"сделал обход при несовпадении количества опций в агенте\" />\r\n    <MESSAGE value=\"Правки в подсветке опций\" />\r\n    <MESSAGE value=\"Допилил подсветку плохих параметров, сделал вывод обнаруженных проблем через ISSUES в status_block\" />\r\n    <MESSAGE value=\"Новое:&#10;- запилил функцию поиска между строками в строке find_between&#10;- продолжил логику аналитики (есть проблемы с параметрами)\" />\r\n    <MESSAGE value=\"//todo перенести в класс Helper внеклассовые методы, начать с ISSUES&#10;// останавливаю разработку до наведения порядка в коде&#10;// нет поля username...\" />\r\n    <MESSAGE value=\"-find_between moved to helper&#10;-debugger refractored\" />\r\n    <MESSAGE value=\"Новое:&#10;- убрал все неклассовые методы в класс Helper&#10;- рефакторинг кода, привёл все методы к каноническому виду&#10;- сделал issueslist как в debugMessages - новой строкой в таблицу status\" />\r\n    <MESSAGE value=\"Новое:&#10;- вывел message и username в блок details\" />\r\n    <MESSAGE value=\"Новое:&#10;- вывожу изменения опций и параметров в соответствующих блоках\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"Новое:&#10;- вывожу изменения опций и параметров в соответствующих блоках\" />\r\n  </component>\r\n  <component name=\"WindowStateProjectService\">\r\n    <state x=\"484\" y=\"71\" key=\"#background.js\" timestamp=\"1610947327296\">\r\n      <screen x=\"0\" y=\"0\" width=\"1536\" height=\"824\" />\r\n    </state>\r\n    <state x=\"484\" y=\"71\" key=\"#background.js/0.0.1536.824@0.0.1536.824\" timestamp=\"1610947327296\" />\r\n    <state x=\"93\" y=\"93\" width=\"1350\" height=\"638\" key=\"DiffContextDialog\" timestamp=\"1611038145093\">\r\n      <screen x=\"0\" y=\"0\" width=\"1536\" height=\"824\" />\r\n    </state>\r\n    <state x=\"93\" y=\"93\" width=\"1350\" height=\"638\" key=\"DiffContextDialog/0.0.1536.824@0.0.1536.824\" timestamp=\"1611038145093\" />\r\n    <state x=\"549\" y=\"167\" key=\"FileChooserDialogImpl\" timestamp=\"1610947540679\">\r\n      <screen x=\"0\" y=\"0\" width=\"1536\" height=\"824\" />\r\n    </state>\r\n    <state x=\"549\" y=\"167\" key=\"FileChooserDialogImpl/0.0.1536.824@0.0.1536.824\" timestamp=\"1610947540679\" />\r\n    <state x=\"400\" y=\"115\" key=\"SettingsEditor\" timestamp=\"1611037578379\">\r\n      <screen x=\"0\" y=\"0\" width=\"1536\" height=\"824\" />\r\n    </state>\r\n    <state x=\"400\" y=\"115\" key=\"SettingsEditor/0.0.1536.824@0.0.1536.824\" timestamp=\"1611037578379\" />\r\n    <state x=\"533\" y=\"201\" key=\"SettingsEditor/0.0.2048.1112@0.0.2048.1112\" timestamp=\"1610983626278\" />\r\n    <state x=\"361\" y=\"145\" key=\"Vcs.Push.Dialog.v2\" timestamp=\"1611045728627\">\r\n      <screen x=\"0\" y=\"0\" width=\"1536\" height=\"824\" />\r\n    </state>\r\n    <state x=\"361\" y=\"145\" key=\"Vcs.Push.Dialog.v2/0.0.1536.824@0.0.1536.824\" timestamp=\"1611045728627\" />\r\n    <state x=\"578\" y=\"326\" key=\"com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2\" timestamp=\"1611035676501\">\r\n      <screen x=\"0\" y=\"0\" width=\"1536\" height=\"824\" />\r\n    </state>\r\n    <state x=\"578\" y=\"326\" key=\"com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2/0.0.1536.824@0.0.1536.824\" timestamp=\"1611035676501\" />\r\n    <state x=\"1004\" y=\"271\" key=\"refactoring.ChangeSignatureDialog\" timestamp=\"1610986063921\">\r\n      <screen x=\"0\" y=\"0\" width=\"2048\" height=\"1112\" />\r\n    </state>\r\n    <state x=\"1004\" y=\"271\" key=\"refactoring.ChangeSignatureDialog/0.0.2048.1112@0.0.2048.1112\" timestamp=\"1610986063921\" />\r\n  </component>\r\n  <component name=\"XDebuggerManager\">\r\n    <breakpoint-manager>\r\n      <breakpoints>\r\n        <line-breakpoint enabled=\"true\" type=\"javascript\">\r\n          <url>file://$PROJECT_DIR$/LARQA/background.js</url>\r\n          <line>370</line>\r\n          <properties lambdaOrdinal=\"-1\" />\r\n          <option name=\"timeStamp\" value=\"1\" />\r\n        </line-breakpoint>\r\n      </breakpoints>\r\n    </breakpoint-manager>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/workspace.xml	(revision 6e2cab2153d9ec9c144e59a9d524b26c5d4c9d89)
+++ .idea/workspace.xml	(date 1611115067646)
@@ -186,7 +186,7 @@
       <workItem from="1610606240104" duration="2972000" />
       <workItem from="1610624796123" duration="10445000" />
       <workItem from="1610943539998" duration="16283000" />
-      <workItem from="1610963158787" duration="10903000" />
+      <workItem from="1610963158787" duration="11022000" />
     </task>
     <task id="LOCAL-00008" summary="- передалал туду листы">
       <created>1604254763003</created>
@@ -321,7 +321,14 @@
       <option name="project" value="LOCAL" />
       <updated>1611045718905</updated>
     </task>
-    <option name="localTasksCounter" value="27" />
+    <task id="LOCAL-00027" summary="Правки ошибок">
+      <created>1611045770862</created>
+      <option name="number" value="00027" />
+      <option name="presentableId" value="LOCAL-00027" />
+      <option name="project" value="LOCAL" />
+      <updated>1611045770862</updated>
+    </task>
+    <option name="localTasksCounter" value="28" />
     <option name="createChangelist" value="false" />
     <option name="createBranch" value="false" />
     <option name="useBranch" value="true" />
@@ -367,7 +374,8 @@
     <MESSAGE value="Новое:&#10;- убрал все неклассовые методы в класс Helper&#10;- рефакторинг кода, привёл все методы к каноническому виду&#10;- сделал issueslist как в debugMessages - новой строкой в таблицу status" />
     <MESSAGE value="Новое:&#10;- вывел message и username в блок details" />
     <MESSAGE value="Новое:&#10;- вывожу изменения опций и параметров в соответствующих блоках" />
-    <option name="LAST_COMMIT_MESSAGE" value="Новое:&#10;- вывожу изменения опций и параметров в соответствующих блоках" />
+    <MESSAGE value="Правки ошибок" />
+    <option name="LAST_COMMIT_MESSAGE" value="Правки ошибок" />
   </component>
   <component name="WindowStateProjectService">
     <state x="484" y="71" key="#background.js" timestamp="1610947327296">
@@ -387,14 +395,14 @@
     </state>
     <state x="400" y="115" key="SettingsEditor/0.0.1536.824@0.0.1536.824" timestamp="1611037578379" />
     <state x="533" y="201" key="SettingsEditor/0.0.2048.1112@0.0.2048.1112" timestamp="1610983626278" />
-    <state x="361" y="145" key="Vcs.Push.Dialog.v2" timestamp="1611045728627">
+    <state x="361" y="145" key="Vcs.Push.Dialog.v2" timestamp="1611045774726">
       <screen x="0" y="0" width="1536" height="824" />
     </state>
-    <state x="361" y="145" key="Vcs.Push.Dialog.v2/0.0.1536.824@0.0.1536.824" timestamp="1611045728627" />
-    <state x="578" y="326" key="com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2" timestamp="1611035676501">
+    <state x="361" y="145" key="Vcs.Push.Dialog.v2/0.0.1536.824@0.0.1536.824" timestamp="1611045774726" />
+    <state x="578" y="326" key="com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2" timestamp="1611115067622">
       <screen x="0" y="0" width="1536" height="824" />
     </state>
-    <state x="578" y="326" key="com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2/0.0.1536.824@0.0.1536.824" timestamp="1611035676501" />
+    <state x="578" y="326" key="com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2/0.0.1536.824@0.0.1536.824" timestamp="1611115067622" />
     <state x="1004" y="271" key="refactoring.ChangeSignatureDialog" timestamp="1610986063921">
       <screen x="0" y="0" width="2048" height="1112" />
     </state>
@@ -405,7 +413,7 @@
       <breakpoints>
         <line-breakpoint enabled="true" type="javascript">
           <url>file://$PROJECT_DIR$/LARQA/background.js</url>
-          <line>370</line>
+          <line>371</line>
           <properties lambdaOrdinal="-1" />
           <option name="timeStamp" value="1" />
         </line-breakpoint>
